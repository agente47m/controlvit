<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CONTROLVIT</title>
    <style>

        body {
            background-color: #f0f0f0; /* Fondo  claro */
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            font-family: Arial, sans-serif; /* Cambio de tipografía */
            display: block;
        }
        .header-container{
            display: flex;
            align-items: center;
            justify-content: center;
            color: rgb(255, 255, 255);
            text-anchor: middle;
            font-family: sans-serif;
            font-size: 20px;
            font-weight: bold;
            background-color: #cb302d;
            border-bottom-left-radius: 25px;
            border-bottom-right-radius: 25px;
            padding-top: 10px;
        }
        .container{
            display: flex;
            align-items:center;
            justify-content: space-around;

        }
     
        .container-card{
            margin-top: 60px;
            display:flex  ;
            justify-content:space-around;
        }
        .card{
            background-color: #fff; /* Tarjeta blanca */
            border-radius: 20px; /* Bordes redondeados */
            display: flex;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
            width: 215px;
            height: 215px;
            margin-left: 20px;
            
        }
        .card-text{
            background-color: #fff; /* Tarjeta blanca */
            border-radius: 20px; /* Bordes redondeados */
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
            width: 215px;
            height: 215px;
            margin-left: 20px;

            
        }
        .card-titulo{
            display: flex;
            align-items: center;
            justify-content: center;
            color: rgb(129, 129, 129);
            text-anchor: middle;
            font-family: sans-serif;
            font-size: 20px;
            font-weight: bold;
        }
        .card-value{
            display: flex;
            align-items: center;
            justify-content: center;
            color: rgb(12, 12, 12);
            text-anchor:middle;
            font-family: sans-serif;
            font-size: 40px;
            font-weight: bold;

        }
        .card-senal{
            font-size: 20px;
            font-family: sans-serif;
            align-items: center;
        }
        .card-item-senal{
            display: flex;
            align-items: center;
            justify-content: space-around;


        }
        .gauge {
        width: 205px;
        height: 205px;
    }

    @media screen and (max-width: 430px){
        
        .container-card{
            margin-top: 60px;
            display:block;  
            justify-content: space-between;
            align-items: center;
        }
        .card{
            width: 115px;
            height: 115px;
            margin-top: 10px;
        }


        .card-text{
            margin-top: 20px;
            width: 115px;
            height: 115px;


        }

        .gauge { 
        width: 105px;
        height: 105px;
         }

         .card-titulo{
            font-size: 10px;


         }
         .card-value{
            font-size: 20px;

         }
         .card-senal{
            font-size: 10px;

         }



    }


    </style>
</head>
<body>

    <div class="header-container">
        <p>CONTROLVIT <samp id="modelo"> n/a</samp></p>
    </div>


<div class="container">

<div class="container-card">

 
    <div class="card-text">
        <div class="card-titulo">
            <p>Frecuencia</p>
        </div>
        <div class="card-value">
            <p id="hz">-</p>
        </div>
        
    </div>

    <div class="card-text">
        <div class="card-titulo">
            <p>RPM</p>
        </div>
        <div class="card-value">
            <p id="RPM">-</p>
        </div>
        
    </div>
</div>




    <div class="container-card">

        <div class="card-text">
            <div class="card-titulo">
                <p>Estado</p>
            </div>
            <div class="card-value">
                <p id="estado">OK</p>
            </div>
            
        </div>

        <div class="card-text">
            <div class="card-titulo">
                <p>CO2</p>
            </div>
            <div class="card-value">
                <p id="co2">2,33 kg</p>
            </div>
            
        </div>


        
    </div>

</div>

<div class="container">


    <div class="container-card">

        <div class="card-text">
            <div class="card-titulo">
                <p>Tension de salida</p>
            </div>
            <div class="card-value">
                <p id="Tsalida">230v</p>
            </div>
            
        </div>

        <div class="card-text">
            <div class="card-titulo">
                <p>Intensidad de salida</p>
            </div>
            <div class="card-value">
                <p id="Isalida">10A</p>
            </div>
            
        </div>

    </div>

    <div class="container-card">


        <div class="card-text">
            <div class="card-titulo">
                <p>Tension bus dc</p>
            </div>
            <div class="card-value">
                <p id="Tbus">411V</p>
            </div>
            
        </div>

        <div class="card-text">
            <div class="card-titulo">
                <p>Estado señales</p>
            </div>
            <div class="card-senal">
                <div class="card-item-senal">
                    <p>A1:</p>
                    <p id="A1"> 2.3V</p>
                </div>
                
                <div class="card-item-senal">
                    <p>A2:</p>
                    <p id="A2"> 1.8V</p>
                </div>
                <div class="card-item-senal">
                    <p>A3:</p>
                    <p id="A3"> 0.0V</p>
                </div>
            </div>
            
        </div>

    </div>
</div>

 
<script>

// definimos programa
const a1=document.getElementById("A1");
const a2=document.getElementById("A2");
const a3=document.getElementById("A3");
const Tbus=document.getElementById("Tbus");
const Isalida=document.getElementById("Isalida");
const Tsalida=document.getElementById("Tsalida");
const co2=document.getElementById("co2");
const estado=document.getElementById("estado");
const modelo=document.getElementById("modelo");
const frecuencia=document.getElementById("hz");
const rpm=document.getElementById("RPM");


function consultaGet(){
        var xmlhttp = new XMLHttpRequest();
        xmlhttp.onreadystatechange = function() {
        if (xmlhttp.readyState == XMLHttpRequest.DONE) {
           if (xmlhttp.status == 200) {
                let data= JSON.parse(xmlhttp.responseText);
                //estado.innerText=data.estado;
                a1.innerText=data.A1 + "V";
                a2.innerText=data.A2+ "V";
                a3.innerText=data.A3+ "V";
                Tbus.innerText=data.Tbus+ "V";
                Isalida.innerText=data.Isalida+ "A";
                Tsalida.innerText=data.Tsalida+ "V";
                frecuencia.innerText=data.hz;
                rpm.innerText=data.rpm;

                co2.innerText="n/a";
                switch(data.modelo){
                    case 269:
                    modelo.innerText=" CV-10";
                        break;
                    case 262:
                    modelo.innerText=" CV-30";
                        break;
                    case 263:
                    modelo.innerText=" CV-50";
                        break;
                    default:
                    modelo.innerText=" na";
                        break;
                }

                switch(data.estado){
                    case 1:
                    estado.innerText="Adelante";
                    break;
                    case 2:
                    estado.innerText="Inverso";
                    break;
                    case 3:
                    estado.innerText="Paro";
                    break;
                    case 4:
                    estado.innerText="Fallo";
                    break;
                    case 5:
                    estado.innerText="POFF";
                    break;
                    case 6:
                    estado.innerText="Preexcitacion";
                    break;
                    default:
                    estado.innerText="N/A";

                    break;
                }

              //estado.innerText=data.estado;

           }
           else {
              console.log('error', xmlhttp);
           }
        }
    };
    xmlhttp.open("GET", "data", true);//data TIENE QUE SER UN ENDPOINT DEFINIDO EN NUESTRA ESP32
    xmlhttp.send();

    }

    (function scheduleAjax() {
    consultaGet();                       //  funcion EJECUTAR LA FUNCION CADA SEGUNDO
    setTimeout(scheduleAjax, 1000);
    })();
</script>
</body>